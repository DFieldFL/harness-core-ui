{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "required": ["type", "name", "identifier", "spec"],
  "properties": {
    "name": {
      "type": "string"
    },
    "identifier": {
      "type": "string"
    },
    "projectIdentifier": {
      "type": "string"
    },
    "organisationIdentifier": {
      "type": "string"
    },
    "description": {
      "type": "string"
    },
    "tags": {
      "$id": "#/properties/tags",
      "type": "array"
    },
    "type": {
      "type": "string",
      "enum": ["SecretText", "SecretFile", "SSHKey"]
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "type": {
            "const": "SecretText"
          }
        }
      },
      "then": {
        "properties": {
          "spec": {
            "type": "object",
            "properties": {
              "secretManagerIdentifier": {
                "type": "string"
              },
              "valueType": {
                "type": "string",
                "enum": ["Inline", "Reference"]
              },
              "value": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "SecretFile"
          }
        }
      },
      "then": {
        "properties": {
          "spec": {
            "type": "object",
            "properties": {
              "secretManagerIdentifier": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "SSHKey"
          }
        }
      },
      "then": {
        "properties": {
          "spec": {
            "type": "object",
            "properties": {
              "port": {
                "type": "number"
              },
              "authScheme": {
                "type": "string",
                "enum": ["SSH", "Kerberos"]
              }
            },
            "allOf": [
              {
                "if": {
                  "properties": {
                    "authScheme": {
                      "const": "SSH"
                    }
                  }
                },
                "then": {
                  "properties": {
                    "spec": {
                      "type": "object",
                      "properties": {
                        "credentialType": {
                          "type": "string",
                          "enum": ["Password", "KeyPath", "KeyReference"]
                        }
                      },
                      "allOf": [
                        {
                          "if": {
                            "properties": {
                              "credentialType": {
                                "const": "Password"
                              }
                            }
                          },
                          "then": {
                            "properties": {
                              "spec": {
                                "type": "object",
                                "properties": {
                                  "userName": {
                                    "type": "string"
                                  },
                                  "password": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        },
                        {
                          "if": {
                            "properties": {
                              "credentialType": {
                                "const": "KeyPath"
                              }
                            }
                          },
                          "then": {
                            "properties": {
                              "spec": {
                                "type": "object",
                                "properties": {
                                  "userName": {
                                    "type": "string"
                                  },
                                  "keyPath": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        },
                        {
                          "if": {
                            "properties": {
                              "credentialType": {
                                "const": "KeyReference"
                              }
                            }
                          },
                          "then": {
                            "properties": {
                              "spec": {
                                "type": "object",
                                "properties": {
                                  "userName": {
                                    "type": "string"
                                  },
                                  "keyPath": {
                                    "type": "string"
                                  },
                                  "encryptedPassphrase": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "authScheme": {
                      "const": "Kerberos"
                    }
                  }
                },
                "then": {
                  "properties": {
                    "spec": {
                      "type": "object",
                      "properties": {
                        "principal": {
                          "type": "string"
                        },
                        "realm": {
                          "type": "string"
                        },
                        "tgtGenerationMethod": {
                          "type": "string",
                          "enum": ["KeyTabFilePath", "Password", "None"]
                        }
                      },
                      "allOf": [
                        {
                          "if": {
                            "properties": {
                              "tgtGenerationMethod": {
                                "const": "KeyTabFilePath"
                              }
                            }
                          },
                          "then": {
                            "properties": {
                              "spec": {
                                "type": "object",
                                "properties": {
                                  "keyPath": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        },
                        {
                          "if": {
                            "properties": {
                              "tgtGenerationMethod": {
                                "const": "Password"
                              }
                            }
                          },
                          "then": {
                            "properties": {
                              "spec": {
                                "type": "object",
                                "properties": {
                                  "password": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                }
              }
            ]
          }
        }
      }
    }
  ]
}
